<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Studio - MusicGen AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #00d4ff;
            --secondary: #7c3aed;
            --accent: #f59e0b;
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #a1a1a1;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --gradient: linear-gradient(135deg, var(--primary), var(--secondary));
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            z-index: 1000;
            padding: 1rem 0;
            border-bottom: 1px solid var(--glass-border);
        }

        .nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1600px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s ease;
            font-weight: 500;
        }

        .nav-links a:hover,
        .nav-links a.active {
            color: var(--primary);
        }

        /* Main Layout */
        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 6rem 2rem 2rem;
            min-height: 100vh;
        }

        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .page-title {
            font-size: 3rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        /* AI Features Grid */
        .ai-features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .ai-feature-card {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .ai-feature-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 20px 40px rgba(0, 212, 255, 0.2);
        }

        .ai-feature-card.active {
            border-color: var(--primary);
            background: rgba(0, 212, 255, 0.1);
        }

        .feature-icon {
            width: 60px;
            height: 60px;
            background: var(--gradient);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            margin-bottom: 1.5rem;
        }

        .feature-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .feature-description {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .feature-status {
            position: absolute;
            top: 1rem;
            right: 1rem;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .feature-status.available {
            background: var(--success);
            color: white;
        }

        .feature-status.beta {
            background: var(--warning);
            color: white;
        }

        .feature-status.coming-soon {
            background: var(--text-secondary);
            color: white;
        }

        .feature-examples {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .example-tag {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            font-size: 0.7rem;
        }

        /* AI Workspace */
        .ai-workspace {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            display: none;
        }

        .ai-workspace.active {
            display: block;
        }

        .workspace-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--glass-border);
        }

        .workspace-title {
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .workspace-actions {
            display: flex;
            gap: 1rem;
        }

        .btn {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        .btn:hover {
            background: var(--glass-border);
            transform: translateY(-1px);
        }

        .btn-primary {
            background: var(--gradient);
            border-color: var(--primary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Input Sections */
        .input-section {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .text-input {
            width: 100%;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .text-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.2);
        }

        .textarea {
            min-height: 120px;
            resize: vertical;
        }

        .select-input {
            width: 100%;
            padding: 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            color: var(--text-primary);
            cursor: pointer;
        }

        /* Voice Recording */
        .voice-recorder {
            text-align: center;
            padding: 2rem;
            border: 2px dashed var(--glass-border);
            border-radius: 16px;
            transition: all 0.3s ease;
        }

        .voice-recorder.recording {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.1);
        }

        .voice-recorder.has-audio {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .record-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: none;
            background: var(--gradient);
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .record-button:hover {
            transform: scale(1.05);
        }

        .record-button.recording {
            background: var(--error);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Audio Visualizer */
        .audio-visualizer {
            width: 100%;
            height: 60px;
            background: var(--bg-secondary);
            border-radius: 8px;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Processing Status */
        .processing-status {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            display: none;
        }

        .processing-status.active {
            display: block;
        }

        .progress-container {
            margin-bottom: 1rem;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-secondary);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-align: center;
        }

        /* Results Section */
        .results-section {
            background: var(--bg-tertiary);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            display: none;
        }

        .results-section.active {
            display: block;
        }

        .result-item {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .result-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .result-title {
            font-weight: 600;
            color: var(--text-primary);
        }

        .result-actions {
            display: flex;
            gap: 0.5rem;
        }

        .result-btn {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .result-btn:hover {
            background: var(--primary);
            color: white;
        }

        /* Options Grid */
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .option-card {
            background: var(--bg-secondary);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .option-card:hover {
            border-color: var(--primary);
        }

        .option-card.selected {
            border-color: var(--primary);
            background: rgba(0, 212, 255, 0.1);
        }

        .option-icon {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .option-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .option-description {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-container {
                padding: 6rem 1rem 2rem;
            }
            
            .ai-features-grid {
                grid-template-columns: 1fr;
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <nav class="nav">
            <a href="index.html" class="logo">MusicGen AI</a>
            <div class="nav-links">
                <a href="app-super-enhanced.html">Studio</a>
                <a href="ai-studio.html" class="active">AI Studio</a>
                <a href="audio-editor.html">Editor</a>
                <a href="stem-separation.html">Stems</a>
                <a href="profile.html">Profile</a>
            </div>
        </nav>
    </div>

    <div class="main-container">
        <div class="page-header">
            <h1 class="page-title">Advanced AI Studio</h1>
            <p class="page-subtitle">
                Unlock the full power of AI music creation with voice-to-music generation, 
                style transfer, auto-mastering, and intelligent lyrics composition.
            </p>
        </div>

        <!-- AI Features Selection -->
        <div class="ai-features-grid" id="featuresGrid">
            <div class="ai-feature-card" data-feature="voice-to-music">
                <div class="feature-status available">Available</div>
                <div class="feature-icon">
                    <i class="fas fa-microphone"></i>
                </div>
                <h3 class="feature-title">Voice-to-Music</h3>
                <p class="feature-description">
                    Transform your voice into music. Hum, sing, or speak a melody and our AI will 
                    create a full musical arrangement that matches your vocal input's rhythm, 
                    pitch, and emotional tone.
                </p>
                <div class="feature-examples">
                    <span class="example-tag">Humming</span>
                    <span class="example-tag">Vocal Melodies</span>
                    <span class="example-tag">Beatboxing</span>
                    <span class="example-tag">Whistling</span>
                </div>
            </div>

            <div class="ai-feature-card" data-feature="style-transfer">
                <div class="feature-status available">Available</div>
                <div class="feature-icon">
                    <i class="fas fa-palette"></i>
                </div>
                <h3 class="feature-title">Music Style Transfer</h3>
                <p class="feature-description">
                    Transform any music track into a different style or genre while preserving 
                    the original melody and structure. Turn a pop song into jazz, or classical 
                    into electronic.
                </p>
                <div class="feature-examples">
                    <span class="example-tag">Genre Conversion</span>
                    <span class="example-tag">Era Transfer</span>
                    <span class="example-tag">Instrument Swap</span>
                    <span class="example-tag">Mood Change</span>
                </div>
            </div>

            <div class="ai-feature-card" data-feature="auto-mastering">
                <div class="feature-status available">Available</div>
                <div class="feature-icon">
                    <i class="fas fa-sliders-h"></i>
                </div>
                <h3 class="feature-title">AI Auto-Mastering</h3>
                <p class="feature-description">
                    Professional-quality mastering powered by AI. Automatically balance EQ, 
                    apply compression, and optimize loudness to make your tracks sound 
                    radio-ready and competitive.
                </p>
                <div class="feature-examples">
                    <span class="example-tag">EQ Balancing</span>
                    <span class="example-tag">Compression</span>
                    <span class="example-tag">Loudness</span>
                    <span class="example-tag">Stereo Width</span>
                </div>
            </div>

            <div class="ai-feature-card" data-feature="lyrics-generation">
                <div class="feature-status available">Available</div>
                <div class="feature-icon">
                    <i class="fas fa-feather-alt"></i>
                </div>
                <h3 class="feature-title">Lyrics + Music</h3>
                <p class="feature-description">
                    Generate complete songs with both lyrics and music. Provide a theme or 
                    topic, and our AI will create meaningful lyrics with perfectly matched 
                    musical composition.
                </p>
                <div class="feature-examples">
                    <span class="example-tag">Theme-based</span>
                    <span class="example-tag">Rhyme Schemes</span>
                    <span class="example-tag">Song Structure</span>
                    <span class="example-tag">Mood Matching</span>
                </div>
            </div>
        </div>

        <!-- AI Workspace -->
        <div class="ai-workspace" id="aiWorkspace">
            <div class="workspace-header">
                <div class="workspace-title">
                    <i class="fas fa-microphone" id="workspaceIcon"></i>
                    <span id="workspaceTitle">Voice-to-Music Generation</span>
                </div>
                <div class="workspace-actions">
                    <button class="btn" onclick="resetWorkspace()">
                        <i class="fas fa-undo"></i>
                        Reset
                    </button>
                    <button class="btn" onclick="closeWorkspace()">
                        <i class="fas fa-times"></i>
                        Close
                    </button>
                </div>
            </div>

            <!-- Voice-to-Music Workspace -->
            <div id="voiceToMusicWorkspace" class="feature-workspace">
                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-microphone"></i>
                        Voice Input
                    </h3>
                    <div class="voice-recorder" id="voiceRecorder">
                        <button class="record-button" id="recordButton" onclick="toggleRecording()">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <p id="recordingStatus">Click to start recording your voice</p>
                        <div class="audio-visualizer" id="audioVisualizer" style="display: none;"></div>
                    </div>
                </div>

                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-cog"></i>
                        Generation Options
                    </h3>
                    <div class="options-grid">
                        <div class="option-card selected" data-option="melody">
                            <div class="option-icon"><i class="fas fa-music"></i></div>
                            <div class="option-title">Melody Focus</div>
                            <div class="option-description">Emphasize melodic patterns</div>
                        </div>
                        <div class="option-card" data-option="rhythm">
                            <div class="option-icon"><i class="fas fa-drum"></i></div>
                            <div class="option-title">Rhythm Focus</div>
                            <div class="option-description">Emphasize rhythmic patterns</div>
                        </div>
                        <div class="option-card" data-option="harmony">
                            <div class="option-icon"><i class="fas fa-layer-group"></i></div>
                            <div class="option-title">Harmony Focus</div>
                            <div class="option-description">Add harmonic complexity</div>
                        </div>
                        <div class="option-card" data-option="emotion">
                            <div class="option-icon"><i class="fas fa-heart"></i></div>
                            <div class="option-title">Emotion Focus</div>
                            <div class="option-description">Match emotional tone</div>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Musical Style (Optional)</label>
                        <input type="text" class="text-input" id="voiceStyle" 
                               placeholder="e.g., jazz, electronic, classical...">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Duration (seconds)</label>
                        <select class="select-input" id="voiceDuration">
                            <option value="15">15 seconds</option>
                            <option value="30" selected>30 seconds</option>
                            <option value="60">1 minute</option>
                            <option value="120">2 minutes</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-primary" id="generateFromVoiceBtn" onclick="generateFromVoice()" disabled>
                        <i class="fas fa-magic"></i>
                        Generate Music from Voice
                    </button>
                </div>
            </div>

            <!-- Style Transfer Workspace -->
            <div id="styleTransferWorkspace" class="feature-workspace" style="display: none;">
                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-upload"></i>
                        Source Audio
                    </h3>
                    <div class="voice-recorder" id="audioUploader" onclick="selectAudioFile()">
                        <div class="option-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                        <p>Click to upload audio file or drag & drop</p>
                        <p style="font-size: 0.8rem; color: var(--text-secondary);">Supports: MP3, WAV, FLAC</p>
                    </div>
                    <input type="file" id="audioFileInput" accept="audio/*" style="display: none;" onchange="handleAudioFile(event)">
                </div>

                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-palette"></i>
                        Target Style
                    </h3>
                    <div class="options-grid">
                        <div class="option-card" data-style="jazz">
                            <div class="option-icon"><i class="fas fa-saxophone"></i></div>
                            <div class="option-title">Jazz</div>
                            <div class="option-description">Swing, improvisation</div>
                        </div>
                        <div class="option-card" data-style="electronic">
                            <div class="option-icon"><i class="fas fa-robot"></i></div>
                            <div class="option-title">Electronic</div>
                            <div class="option-description">Synths, beats</div>
                        </div>
                        <div class="option-card" data-style="classical">
                            <div class="option-icon"><i class="fas fa-violin"></i></div>
                            <div class="option-title">Classical</div>
                            <div class="option-description">Orchestra, formal</div>
                        </div>
                        <div class="option-card" data-style="rock">
                            <div class="option-icon"><i class="fas fa-guitar"></i></div>
                            <div class="option-title">Rock</div>
                            <div class="option-description">Electric, powerful</div>
                        </div>
                        <div class="option-card" data-style="ambient">
                            <div class="option-icon"><i class="fas fa-cloud"></i></div>
                            <div class="option-title">Ambient</div>
                            <div class="option-description">Atmospheric, calm</div>
                        </div>
                        <div class="option-card" data-style="latin">
                            <div class="option-icon"><i class="fas fa-salsa"></i></div>
                            <div class="option-title">Latin</div>
                            <div class="option-description">Rhythm, spice</div>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Custom Style Description</label>
                        <input type="text" class="text-input" id="customStyle" 
                               placeholder="Describe the desired style...">
                    </div>

                    <div class="input-group">
                        <label>
                            <input type="checkbox" id="keepMelody" checked> Keep original melody
                        </label>
                    </div>
                    <div class="input-group">
                        <label>
                            <input type="checkbox" id="keepRhythm"> Keep original rhythm
                        </label>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-primary" id="transferStyleBtn" onclick="transferStyle()" disabled>
                        <i class="fas fa-magic"></i>
                        Transfer Style
                    </button>
                </div>
            </div>

            <!-- Auto-Mastering Workspace -->
            <div id="autoMasteringWorkspace" class="feature-workspace" style="display: none;">
                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-upload"></i>
                        Audio to Master
                    </h3>
                    <div class="voice-recorder" id="masteringUploader" onclick="selectMasteringFile()">
                        <div class="option-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                        <p>Upload track for mastering</p>
                    </div>
                    <input type="file" id="masteringFileInput" accept="audio/*" style="display: none;" onchange="handleMasteringFile(event)">
                </div>

                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-sliders-h"></i>
                        Mastering Settings
                    </h3>
                    <div class="options-grid">
                        <div class="option-card selected" data-preset="balanced">
                            <div class="option-icon"><i class="fas fa-balance-scale"></i></div>
                            <div class="option-title">Balanced</div>
                            <div class="option-description">All-around good sound</div>
                        </div>
                        <div class="option-card" data-preset="loud">
                            <div class="option-icon"><i class="fas fa-volume-up"></i></div>
                            <div class="option-title">Loud</div>
                            <div class="option-description">Maximum loudness</div>
                        </div>
                        <div class="option-card" data-preset="dynamic">
                            <div class="option-icon"><i class="fas fa-wave-square"></i></div>
                            <div class="option-title">Dynamic</div>
                            <div class="option-description">Preserve dynamics</div>
                        </div>
                        <div class="option-card" data-preset="warm">
                            <div class="option-icon"><i class="fas fa-sun"></i></div>
                            <div class="option-title">Warm</div>
                            <div class="option-description">Vintage warmth</div>
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Target Genre</label>
                        <select class="select-input" id="masteringGenre">
                            <option value="auto">Auto-detect</option>
                            <option value="pop">Pop</option>
                            <option value="rock">Rock</option>
                            <option value="electronic">Electronic</option>
                            <option value="hip-hop">Hip Hop</option>
                            <option value="jazz">Jazz</option>
                            <option value="classical">Classical</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-primary" id="autoMasterBtn" onclick="autoMaster()" disabled>
                        <i class="fas fa-magic"></i>
                        Auto-Master Track
                    </button>
                </div>
            </div>

            <!-- Lyrics Generation Workspace -->
            <div id="lyricsGenerationWorkspace" class="feature-workspace" style="display: none;">
                <div class="input-section">
                    <h3 class="section-title">
                        <i class="fas fa-feather-alt"></i>
                        Song Concept
                    </h3>
                    <div class="input-group">
                        <label class="input-label">Song Theme or Topic</label>
                        <textarea class="text-input textarea" id="songTheme" 
                                  placeholder="Describe what your song should be about..."></textarea>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Mood/Emotion</label>
                        <select class="select-input" id="songMood">
                            <option value="happy">Happy & Uplifting</option>
                            <option value="sad">Sad & Melancholic</option>
                            <option value="romantic">Romantic & Loving</option>
                            <option value="energetic">Energetic & Powerful</option>
                            <option value="peaceful">Peaceful & Calm</option>
                            <option value="nostalgic">Nostalgic & Reflective</option>
                            <option value="angry">Angry & Rebellious</option>
                            <option value="hopeful">Hopeful & Inspiring</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Musical Genre</label>
                        <select class="select-input" id="lyricsGenre">
                            <option value="pop">Pop</option>
                            <option value="rock">Rock</option>
                            <option value="hip-hop">Hip Hop</option>
                            <option value="country">Country</option>
                            <option value="folk">Folk</option>
                            <option value="electronic">Electronic</option>
                            <option value="jazz">Jazz</option>
                            <option value="r&b">R&B</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Song Structure</label>
                        <select class="select-input" id="songStructure">
                            <option value="verse-chorus">Verse-Chorus</option>
                            <option value="verse-chorus-bridge">Verse-Chorus-Bridge</option>
                            <option value="aaba">AABA</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="btn btn-primary" id="generateLyricsBtn" onclick="generateLyricsWithMusic()">
                        <i class="fas fa-magic"></i>
                        Generate Song with Lyrics
                    </button>
                </div>
            </div>
        </div>

        <!-- Processing Status -->
        <div class="processing-status" id="processingStatus">
            <h3 class="section-title">
                <i class="fas fa-cog fa-spin"></i>
                AI Processing
            </h3>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="progress-text" id="progressText">Initializing...</div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <h3 class="section-title">
                <i class="fas fa-check-circle"></i>
                AI Generated Results
            </h3>
            <div id="resultsContainer">
                <!-- Results will be populated here -->
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-primary" onclick="saveToLibrary()">
                    <i class="fas fa-save"></i>
                    Save to Library
                </button>
                <button class="btn" onclick="shareResult()">
                    <i class="fas fa-share"></i>
                    Share
                </button>
                <button class="btn" onclick="downloadResult()">
                    <i class="fas fa-download"></i>
                    Download
                </button>
            </div>
        </div>
    </div>

    <script type="module">
        import { AdvancedAIEngine } from './js/advanced-ai-engine.js';

        // Global state
        let aiEngine = null;
        let currentFeature = null;
        let currentRecording = null;
        let currentAudioFile = null;
        let currentResult = null;
        let mediaRecorder = null;
        let recordedChunks = [];

        // Initialize AI Studio
        document.addEventListener('DOMContentLoaded', async () => {
            await initializeAIStudio();
            setupEventListeners();
        });

        async function initializeAIStudio() {
            try {
                aiEngine = new AdvancedAIEngine();
                
                // Set up AI engine listeners
                aiEngine.on('progress', (data) => {
                    updateProgress(data.percentage, data.message);
                });
                
                aiEngine.on('voiceToMusicCompleted', (data) => {
                    showResults('Voice-to-Music Generation Complete', data.result);
                });
                
                aiEngine.on('styleTransferCompleted', (data) => {
                    showResults('Style Transfer Complete', data.result);
                });
                
                aiEngine.on('autoMasteringCompleted', (data) => {
                    showResults('Auto-Mastering Complete', data.result);
                });
                
                aiEngine.on('lyricsGenerationCompleted', (data) => {
                    showResults('Lyrics Generation Complete', data.result);
                });
                
                console.log('AI Studio initialized');
            } catch (error) {
                console.error('Failed to initialize AI Studio:', error);
            }
        }

        function setupEventListeners() {
            // Feature card selection
            document.querySelectorAll('.ai-feature-card').forEach(card => {
                card.addEventListener('click', () => {
                    selectFeature(card.dataset.feature);
                });
            });

            // Option card selection
            document.addEventListener('click', (e) => {
                if (e.target.closest('.option-card')) {
                    const card = e.target.closest('.option-card');
                    const container = card.parentElement;
                    
                    // Single selection for some, multiple for others
                    if (container.classList.contains('single-select') || 
                        card.closest('#styleTransferWorkspace') ||
                        card.closest('#autoMasteringWorkspace')) {
                        container.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
                    }
                    
                    card.classList.toggle('selected');
                }
            });
        }

        function selectFeature(feature) {
            currentFeature = feature;
            
            // Update feature cards
            document.querySelectorAll('.ai-feature-card').forEach(card => {
                card.classList.remove('active');
            });
            document.querySelector(`[data-feature="${feature}"]`).classList.add('active');
            
            // Show workspace
            showWorkspace(feature);
        }

        function showWorkspace(feature) {
            const workspace = document.getElementById('aiWorkspace');
            const workspaceTitle = document.getElementById('workspaceTitle');
            const workspaceIcon = document.getElementById('workspaceIcon');
            
            // Hide all feature workspaces
            document.querySelectorAll('.feature-workspace').forEach(ws => {
                ws.style.display = 'none';
            });
            
            // Show selected workspace
            const featureWorkspace = document.getElementById(feature.replace('-', '') + 'Workspace');
            if (featureWorkspace) {
                featureWorkspace.style.display = 'block';
            }
            
            // Update header
            const featureInfo = {
                'voice-to-music': { icon: 'fas fa-microphone', title: 'Voice-to-Music Generation' },
                'style-transfer': { icon: 'fas fa-palette', title: 'Music Style Transfer' },
                'auto-mastering': { icon: 'fas fa-sliders-h', title: 'AI Auto-Mastering' },
                'lyrics-generation': { icon: 'fas fa-feather-alt', title: 'Lyrics + Music Generation' }
            };
            
            const info = featureInfo[feature];
            workspaceIcon.className = info.icon;
            workspaceTitle.textContent = info.title;
            
            workspace.classList.add('active');
        }

        // Voice Recording Functions
        window.toggleRecording = async function() {
            const button = document.getElementById('recordButton');
            const status = document.getElementById('recordingStatus');
            const recorder = document.getElementById('voiceRecorder');
            
            if (!mediaRecorder || mediaRecorder.state === 'inactive') {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    recordedChunks = [];
                    
                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'audio/wav' });
                        currentRecording = blob;
                        
                        button.classList.remove('recording');
                        button.innerHTML = '<i class="fas fa-microphone"></i>';
                        status.textContent = 'Recording saved! Ready to generate music.';
                        recorder.classList.add('has-audio');
                        
                        document.getElementById('generateFromVoiceBtn').disabled = false;
                        
                        // Stop all tracks
                        stream.getTracks().forEach(track => track.stop());
                    };
                    
                    mediaRecorder.start();
                    button.classList.add('recording');
                    button.innerHTML = '<i class="fas fa-stop"></i>';
                    status.textContent = 'Recording... Click to stop.';
                    recorder.classList.add('recording');
                    
                } catch (error) {
                    alert('Microphone access denied or not available');
                }
            } else {
                mediaRecorder.stop();
            }
        };

        // File Upload Functions
        window.selectAudioFile = function() {
            document.getElementById('audioFileInput').click();
        };

        window.handleAudioFile = function(event) {
            const file = event.target.files[0];
            if (file) {
                currentAudioFile = file;
                document.getElementById('audioUploader').innerHTML = `
                    <div class="option-icon"><i class="fas fa-music"></i></div>
                    <p>Audio file loaded: ${file.name}</p>
                `;
                document.getElementById('audioUploader').classList.add('has-audio');
                document.getElementById('transferStyleBtn').disabled = false;
            }
        };

        window.selectMasteringFile = function() {
            document.getElementById('masteringFileInput').click();
        };

        window.handleMasteringFile = function(event) {
            const file = event.target.files[0];
            if (file) {
                currentAudioFile = file;
                document.getElementById('masteringUploader').innerHTML = `
                    <div class="option-icon"><i class="fas fa-music"></i></div>
                    <p>Audio file loaded: ${file.name}</p>
                `;
                document.getElementById('masteringUploader').classList.add('has-audio');
                document.getElementById('autoMasterBtn').disabled = false;
            }
        };

        // AI Generation Functions
        window.generateFromVoice = async function() {
            if (!currentRecording) {
                alert('Please record your voice first');
                return;
            }

            const options = {
                style: document.getElementById('voiceStyle').value,
                duration: parseInt(document.getElementById('voiceDuration').value),
                focus: getSelectedOptions('voiceToMusicWorkspace')
            };

            showProcessing();
            
            try {
                currentResult = await aiEngine.generateMusicFromVoice(currentRecording, options);
            } catch (error) {
                hideProcessing();
                alert('Generation failed: ' + error.message);
            }
        };

        window.transferStyle = async function() {
            if (!currentAudioFile) {
                alert('Please upload an audio file first');
                return;
            }

            const selectedStyles = getSelectedOptions('styleTransferWorkspace');
            const customStyle = document.getElementById('customStyle').value;
            const targetStyle = selectedStyles[0] || customStyle;

            if (!targetStyle) {
                alert('Please select a target style');
                return;
            }

            const options = {
                targetStyle: targetStyle,
                keepMelody: document.getElementById('keepMelody').checked,
                keepRhythm: document.getElementById('keepRhythm').checked
            };

            showProcessing();
            
            try {
                // Convert file to audio buffer first (simplified for demo)
                currentResult = await aiEngine.transferMusicStyle(currentAudioFile, targetStyle, options);
            } catch (error) {
                hideProcessing();
                alert('Style transfer failed: ' + error.message);
            }
        };

        window.autoMaster = async function() {
            if (!currentAudioFile) {
                alert('Please upload an audio file first');
                return;
            }

            const preset = getSelectedOptions('autoMasteringWorkspace')[0];
            const genre = document.getElementById('masteringGenre').value;

            const options = {
                preset: preset,
                genre: genre
            };

            showProcessing();
            
            try {
                // Convert file to audio buffer first (simplified for demo)
                currentResult = await aiEngine.autoMasterTrack(currentAudioFile, options);
            } catch (error) {
                hideProcessing();
                alert('Auto-mastering failed: ' + error.message);
            }
        };

        window.generateLyricsWithMusic = async function() {
            const theme = document.getElementById('songTheme').value;
            if (!theme.trim()) {
                alert('Please provide a song theme or topic');
                return;
            }

            const options = {
                theme: theme,
                mood: document.getElementById('songMood').value,
                genre: document.getElementById('lyricsGenre').value,
                structure: document.getElementById('songStructure').value
            };

            showProcessing();
            
            try {
                currentResult = await aiEngine.generateLyricsWithMusic(theme, options);
            } catch (error) {
                hideProcessing();
                alert('Lyrics generation failed: ' + error.message);
            }
        };

        // Utility Functions
        function getSelectedOptions(workspaceId) {
            const workspace = document.getElementById(workspaceId);
            const selected = workspace.querySelectorAll('.option-card.selected');
            return Array.from(selected).map(card => card.dataset.option || card.dataset.style || card.dataset.preset);
        }

        function showProcessing() {
            document.getElementById('processingStatus').classList.add('active');
            document.getElementById('resultsSection').classList.remove('active');
        }

        function hideProcessing() {
            document.getElementById('processingStatus').classList.remove('active');
        }

        function updateProgress(percentage, message) {
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = message;
        }

        function showResults(title, result) {
            hideProcessing();
            
            const resultsContainer = document.getElementById('resultsContainer');
            resultsContainer.innerHTML = `
                <div class="result-item">
                    <div class="result-header">
                        <div class="result-title">${title}</div>
                        <div class="result-actions">
                            <button class="result-btn" onclick="playResult()" title="Play">
                                <i class="fas fa-play"></i>
                            </button>
                            <button class="result-btn" onclick="editResult()" title="Edit">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="result-btn" onclick="shareResult()" title="Share">
                                <i class="fas fa-share"></i>
                            </button>
                        </div>
                    </div>
                    <div class="result-content">
                        ${formatResult(result)}
                    </div>
                </div>
            `;
            
            document.getElementById('resultsSection').classList.add('active');
        }

        function formatResult(result) {
            if (result.lyrics) {
                return `
                    <div><strong>Lyrics:</strong></div>
                    <div style="white-space: pre-line; margin: 1rem 0;">${result.lyrics.verses.join('\n')}</div>
                    <div><strong>Music:</strong> Generated track available for playback</div>
                `;
            } else if (result.audio_url) {
                return `
                    <div><strong>Generated Audio:</strong></div>
                    <audio controls style="width: 100%; margin: 1rem 0;">
                        <source src="${result.audio_url}" type="audio/mpeg">
                    </audio>
                `;
            } else {
                return '<div>AI processing complete. Result ready for playback.</div>';
            }
        }

        // Action Functions
        window.resetWorkspace = function() {
            currentRecording = null;
            currentAudioFile = null;
            
            // Reset all forms
            document.querySelectorAll('.text-input').forEach(input => input.value = '');
            document.querySelectorAll('.option-card').forEach(card => card.classList.remove('selected'));
            document.querySelectorAll('.voice-recorder').forEach(recorder => {
                recorder.classList.remove('has-audio', 'recording');
            });
            
            // Reset buttons
            document.querySelectorAll('.btn-primary').forEach(btn => btn.disabled = true);
            
            hideProcessing();
            document.getElementById('resultsSection').classList.remove('active');
        };

        window.closeWorkspace = function() {
            document.getElementById('aiWorkspace').classList.remove('active');
            document.querySelectorAll('.ai-feature-card').forEach(card => card.classList.remove('active'));
            resetWorkspace();
        };

        window.playResult = function() {
            // Implement result playback
            console.log('Playing result:', currentResult);
        };

        window.editResult = function() {
            // Open in audio editor
            window.location.href = 'audio-editor.html';
        };

        window.shareResult = function() {
            // Implement sharing
            console.log('Sharing result:', currentResult);
        };

        window.downloadResult = function() {
            // Implement download
            console.log('Downloading result:', currentResult);
        };

        window.saveToLibrary = function() {
            // Save to user library
            console.log('Saving to library:', currentResult);
            alert('Result saved to your library!');
        };
    </script>
</body>
</html>